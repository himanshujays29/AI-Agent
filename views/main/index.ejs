<% layout('/layout/layout') -%>
<div class="max-w-5xl mx-auto py-4 mb-40">
  <h1 class="text-2xl font-bold text-center mb-6">
    ğŸ“š Exam Preparation Dashboard
  </h1>


  <div id="status" class="my-4 text-chatgpt-subtle text-sm"></div>

  <div id="output" class="hidden">
    <div class="card">
      <h2 class="text-2xl font-semibold mb-2">ğŸ” Research</h2>
      <!-- Markdown body with transparent background for dark mode -->
      <div id="research" class="prose markdown-body" style="background-color: transparent;"></div>
    </div>

    <div class="card">
      <h2 class="text-2xl font-semibold mb-2">ğŸ§  Summary</h2>
      <!-- Markdown body with transparent background for dark mode -->
      <div id="summary" class="prose markdown-body" style="background-color: transparent;"></div>
    </div>

    <!-- <button
      id="generateQuizBtn"
      class="mt-4 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 hidden"
    >
      ğŸ¯ Generate Quiz
    </button> -->

    <div
      id="quizOutput"
      class="hidden card markdown-body mt-4"
      style="background-color: transparent;"
    ></div>

    <!-- <button
      id="generateFlashcardsBtn"
      class="mt-4 bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 hidden"
    >
      ğŸ“˜ Generate Flashcards
    </button> -->
    <div
      id="flashcardOutput"
      class="hidden card markdown-body mt-4"
      style="background-color: transparent;"
    ></div>

    <!-- <button
      id="generateDiagramBtn"
      class="mt-4 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 hidden"
    >
      ğŸ§  Generate Mind Map
    </button> -->

    <div
      id="diagramWrapper"
      class="hidden relative card mt-4"
    >
      <div class="absolute top-2 right-2 flex gap-2 z-20">
        <button id="zoomInBtn" class="mind-btn">+</button>
        <button id="zoomOutBtn" class="mind-btn">âˆ’</button>
        <button id="resetZoomBtn" class="mind-btn">âŸ³</button>
        <button id="fullScreenBtn" class="mind-btn">â›¶</button>
      </div>
      <!-- Fixed container: bg-white for diagram visibility, pre-wrap for debugging raw text -->
      <div id="mindmapContainer" class="w-full h-72 overflow-hidden bg-white rounded-lg">
        <div id="mindmapDiagram" class="mermaid" style="white-space: pre-wrap;"></div>
      </div>
    </div>

    <div class="action-buttons-row">
        <button id="generateQuizBtn" class="minimal-btn">
            <i class="fa-solid fa-bullseye"></i> Generate Quiz
        </button>

        <button id="generateFlashcardsBtn" class="minimal-btn">
            <i class="fa-regular fa-clone"></i> Flashcards
        </button>

        <button id="generateDiagramBtn" class="minimal-btn">
            <i class="fa-solid fa-diagram-project"></i> Mind Map
        </button>

        <button id="exportPdfBtn" class="minimal-btn">
            <i class="fa-regular fa-file-pdf"></i> PDF
        </button>

      
    </div>
  </div>
</div>

<div class="input-area-container">
    <form id="studyForm" class="input-box-wrapper">
        <div class="input-top-row">
            <!-- Model Dropdown inside the input box -->
            <select id="model" class="model-select-float">
                <option class="dropdown-menu" value="gemini-2.5-flash-lite" selected>Gemini 2.5 Flash Lite</option>
                <option class="dropdown-menu" value="gemini-2.5-flash">Gemini 2.5 Flash (Pro)</option>
            </select>
        </div>
        
        <div class="input-main-row">
            <input 
                id="topic" 
                class="chat-input" 
                placeholder="Message AI Tutor..." 
                autocomplete="off"
            />
            <button type="submit" class="send-btn-float">
                <i class="fa-solid fa-arrow-up"></i>
            </button>
        </div>
    </form>
    <div class="text-center mt-2">
        <span class="text-[10px] text-chatgpt-subtle">AI can make mistakes. Check important info.</span>
    </div>
</div>